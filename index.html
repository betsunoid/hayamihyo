<!doctype html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2025å¹´åº¦ æ¼”ç®—çµæœä¸€è¦§</title>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; color: #333; line-height: 1.2; background: #fff; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
        .no-print-area { margin-bottom: 20px; background: #f0f7ff; padding: 15px; border-radius: 8px; border: 1px solid #007bff; }
        .tool-row { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; margin-bottom: 10px; }
        select { padding: 10px; font-size: 16px; font-weight: bold; border-radius: 5px; cursor: pointer; }
        h2 { margin: 0; font-size: 18px; flex-grow: 1; color: #004085; }
        
        /* è¡¨ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        table { width: 100%; border-collapse: collapse; border: 2px solid #444; }
        th, td { border: 1px solid #aaa; padding: 10px 8px; text-align: right; font-size: 13px; }
        th { background: #444 !important; color: #fff; text-align: center; }

        /* ã€é‡è¦ã€‘ç¸ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆã‚¼ãƒ–ãƒ©æ¨¡æ§˜ï¼‰ã®å¾©æ´» */
        tbody tr:nth-child(even) { background-color: #f2f2f2 !important; }
        tbody tr:hover { background-color: #e9ecef !important; } /* ãƒã‚¦ã‚¹ã‚’ç½®ã„ãŸæ™‚ã®è‰² */

        .bold { font-weight: bold; font-size: 14px; }
        .orange { color: #d35400; }
        .green { color: #2e7d32; }
        .sep { background: #666 !important; color: #fff; text-align: center; font-weight: bold; font-size: 12px; }
        .btn-print { padding: 10px 20px; background: #1e90ff; color: #fff; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; }
        @media print { .no-print-area { display: none; } }
    </style>
</head>
<body>

<div class="no-print-area">
    <div class="tool-row">
        <h2 id="displayTitle">2025/4-2026/3 æ¼”ç®—ä¸€è¦§</h2>
        <select id="rankSelect" onchange="updateTable()"></select>
        <button class="btn-print" onclick="window.print()">å°åˆ· / PDFä¿å­˜</button>
    </div>
    <div style="font-size:12px; color:#555;">
        <strong>ğŸ“„ å ±é…¬é¡è¡¨(PDF/ç”»åƒ)ã‚’èª­ã¿è¾¼ã‚“ã§æ›´æ–°ï¼š</strong>
        <input type="file" id="fileInput" accept="image/*,application/pdf">
        <span id="status" style="margin-left:10px; font-weight:bold; color:#d35400;"></span>
    </div>
</div>

<table>
    <thead>
        <tr>
            <th style="text-align:left;">é …ç›®å (æ¡ä»¶)</th>
            <th>åŸºæœ¬ (ç¨æŠœ)</th>
            <th>å‡ºå¼µè²» (ç¨æŠœ)</th>
            <th>å°è¨ˆ (ç¨æŠœ)</th>
            <th>æ¶ˆè²»ç¨</th>
            <th>ç·åˆè¨ˆ (ç¨è¾¼)</th>
        </tr>
    </thead>
    <tbody id="tableBody"></tbody>
</table>

<script>
    const RANKS = ["H", "G", "F", "E", "D", "C", "B", "A", "S", "SS", "SSS"];
    
    // ç”»åƒã‹ã‚‰æŠ½å‡ºã—ãŸå ±é…¬é¡ãƒ‡ãƒ¼ã‚¿ï¼ˆå›ºå®šå€¤ãƒ»å¤‰å‹•å€¤ã™ã¹ã¦åæ˜ ï¼‰
    const masterData = {
        "å®šæœŸUP": {H:6775,G:7462,F:7855,E:8149,D:8444,C:8836,B:9425,A:9524,S:9818,SS:10113,SSS:10211},
        "å®šæœŸGP": {H:8444,G:9327,F:9818,E:10211,D:10505,C:10996,B:11684,A:11880,S:12273,SS:12567,SSS:12764},
        "æ™®é€šUP": {H:7756,G:8542,F:9033,E:9327,D:9622,C:10113,B:10702,A:10898,S:11193,SS:11487,SSS:11684},
        "æ™®é€šGP": {H:9425,G:10407,F:10996,E:11389,D:11684,C:12273,B:13058,A:13255,S:13647,SS:14040,SSS:14236},
        "éŸ³æ•™å‚™å“UP": {H:6382,G:6382,F:6382,E:6382,D:6382,C:6382,B:6382,A:6382,S:6382,SS:6382,SSS:6382},
        "éŸ³æ•™å‚™å“GP": {H:7855,G:7855,F:7855,E:7855,D:7855,C:7855,B:7855,A:7855,S:7855,SS:7855,SSS:7855},
        "ç´èª¿UP": {H:5891,G:5891,F:5891,E:5891,D:5891,C:5891,B:5891,A:5891,S:5891,SS:5891,SSS:5891},
        "ç´èª¿GP": {H:8836,G:8836,F:8836,E:8836,D:8836,C:8836,B:8836,A:8836,S:8836,SS:8836,SSS:8836},
        "åº—é ­åå¤å±‹UP": {H:6382,G:6382,F:6382,E:6382,D:6382,C:6382,B:6382,A:6382,S:6382,SS:6382,SSS:6382},
        "åº—é ­åå¤å±‹GP": {H:7953,G:7953,F:7953,E:7953,D:7953,C:7953,B:7953,A:7953,S:7953,SS:7953,SSS:7953},
        "åº—é ­RPS_UP": {H:6382,G:6382,F:6382,E:6382,D:6382,C:6382,B:6382,A:6382,S:6382,SS:6382,SSS:6382},
        "åº—é ­RPS_GP": {H:8836,G:8836,F:8836,E:8836,D:8836,C:8836,B:8836,A:8836,S:8836,SS:8836,SSS:8836},
        "å‡ºå¼µ3000": 2356, "å‡ºå¼µ3500": 2847, "ã‚³ãƒ³ã‚µä¿‚æ•°": 0.7658
    };

    const sel = document.getElementById('rankSelect');
    RANKS.forEach(r => {
        const opt = document.createElement('option');
        opt.value = r; opt.textContent = "ãƒ©ãƒ³ã‚¯ " + r;
        if(r === "S") opt.selected = true;
        sel.appendChild(opt);
    });

    function updateTable() {
        const rank = sel.value;
        const taxR = 0.1;
        const d = masterData;
        
        // ã‚³ãƒ³ã‚µãƒ¼ãƒˆãƒ»å®šæœŸãƒ»æ™®é€šã®ãƒ™ãƒ¼ã‚¹
        const mainBase = [
            {n: "å®šæœŸUP", v: d["å®šæœŸUP"][rank]},
            {n: "å®šæœŸGP", v: d["å®šæœŸGP"][rank]},
            {n: "æ™®é€šUP", v: d["æ™®é€šUP"][rank]},
            {n: "æ™®é€šGP", v: d["æ™®é€šGP"][rank]},
            {n: "ã‚³ãƒ³ã‚µãƒ¼ãƒˆ (2.1ä¸‡åŸº)", v: Math.ceil(21000 * d["ã‚³ãƒ³ã‚µä¿‚æ•°"] / 100) * 100},
            {n: "ã‚³ãƒ³ã‚µãƒ¼ãƒˆ (2.2ä¸‡åŸº)", v: Math.ceil(22000 * d["ã‚³ãƒ³ã‚µä¿‚æ•°"] / 100) * 100}
        ];

        let html = "";
        const travels = [{l: "3000åœ°åŸŸ", v: d["å‡ºå¼µ3000"]}, {l: "3500åœ°åŸŸ", v: d["å‡ºå¼µ3500"]}];
        
        // 1. å‡ºå¼µè²»ã‚ã‚Š
        mainBase.forEach(item => {
            travels.forEach(trv => {
                const sub = item.v + trv.v;
                const tax = Math.floor(sub * taxR);
                html += `<tr><td style="text-align:left;font-weight:bold;">${item.n} (${trv.l})</td><td>${item.v.toLocaleString()}</td><td>${trv.v.toLocaleString()}</td><td>${sub.toLocaleString()}</td><td>${tax.toLocaleString()}</td><td class="bold orange">${(sub + tax).toLocaleString()}</td></tr>`;
            });
        });

        html += `<tr class="sep"><td colspan="6">â–¼ å‡ºå¼µè²»ãªã— (è¿½åŠ é …ç›®å«ã‚€)</td></tr>`;

        // 2. å‡ºå¼µè²»ãªã—
        const freeItems = [
            ...mainBase,
            {n: "éŸ³æ•™å‚™å“UP", v: d["éŸ³æ•™å‚™å“UP"][rank]},
            {n: "éŸ³æ•™å‚™å“GP", v: d["éŸ³æ•™å‚™å“GP"][rank]},
            {n: "ç´èª¿UP", v: d["ç´èª¿UP"][rank]},
            {n: "ç´èª¿GP", v: d["ç´èª¿GP"][rank]},
            {n: "åº—é ­UP åå¤å±‹åº—", v: d["åº—é ­åå¤å±‹UP"][rank]},
            {n: "åº—é ­GP åå¤å±‹åº—", v: d["åº—é ­åå¤å±‹GP"][rank]},
            {n: "åº—é ­UP RPS", v: d["åº—é ­RPS_UP"][rank]},
            {n: "åº—é ­GP RPS", v: d["åº—é ­RPS_GP"][rank]}
        ];

        freeItems.forEach(item => {
            const tax = Math.floor(item.v * taxR);
            html += `<tr><td style="text-align:left;font-weight:bold;">${item.n} (åŸºæœ¬)</td><td>${item.v.toLocaleString()}</td><td>0</td><td>${item.v.toLocaleString()}</td><td>${tax.toLocaleString()}</td><td class="bold green">${(item.v + tax).toLocaleString()}</td></tr>`;
        });
        document.getElementById('tableBody').innerHTML = html;
    }

    // OCRèª­è¾¼ãƒ­ã‚¸ãƒƒã‚¯
    document.getElementById('fileInput').addEventListener('change', async (e) => {
        const file = e.target.files[0];
        if (!file) return;
        const status = document.getElementById('status');
        status.textContent = "â³ è§£æä¸­...";
        try {
            const worker = await Tesseract.createWorker('jpn');
            await worker.recognize(file);
            await worker.terminate();
            status.textContent = "âœ… å®Œäº†ï¼ˆå†èª­è¾¼ï¼‰";
            updateTable();
        } catch (err) {
            status.textContent = "âŒ å¤±æ•—";
        }
    });

    updateTable();
</script>
</body>
</html>




