
<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>æ¼”ç®—çµæœå®Œå…¨ä¸€è¦§_å°åˆ·å¼·åŒ–ç‰ˆ</title>
<style>
/* --- ç”»é¢è¡¨ç¤ºç”¨ --- */
body { font-family: sans-serif; padding: 15px; color: #333; line-height: 1.3; background: #f0f2f5; }
.no-print-area { background: #fff; border: 2px solid #e74c3c; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
.save-btn { background: #28a745; color: #fff; padding: 12px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 10px; display: none; }
.flex-header { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; }
.btn-print { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 14px; }

/* ãƒ†ãƒ¼ãƒ–ãƒ«ã®åŸºæœ¬è¨­å®š */
table { width: 100%; border-collapse: collapse; background: #fff; border: 2px solid #333; }
th, td { border: 1px solid #999; padding: 12px 6px; text-align: right; font-size: 14px; }

/* ãƒ˜ãƒƒãƒ€ãƒ¼ï¼šç”»é¢ã§ã¯é»’ã€å°åˆ·ã§ã¯é»’æ ç™½èƒŒæ™¯ã¸ */
th { background: #333; color: #fff; text-align: center; font-weight: bold; }

/* ã‚¼ãƒ–ãƒ©ï¼šç”»é¢è¡¨ç¤º */
tbody tr:nth-child(even) { background-color: #f8f9fa !important; }

.bold { font-weight: bold; }
.orange { color: #e67e22; }
.green { color: #27ae60; }
.sep { background: #555 !important; color: #fff; text-align: center; font-weight: bold; font-size: 13px; }

/* --- ğŸ–¨ï¸ A4å°åˆ·å°‚ç”¨è¨­å®š (å¼·åŠ›ç‰ˆ) --- */
@media print {
@page { size: A4 portrait; margin: 10mm; }
* { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }

body { background: #fff; padding: 0; }
.no-print-area, .btn-print, select { display: none !important; }

h2 { font-size: 18pt; margin: 0 0 15px 0; text-align: center; color: #000; }

table { border: 1.5pt solid #000; width: 100%; }

/* ãƒ˜ãƒƒãƒ€ãƒ¼ã®è¦–èªæ€§æ”¹å–„ï¼šå°åˆ·æ™‚ã¯ç™½èƒŒæ™¯ã«é»’æ–‡å­—ã€å¤ªæ  */
th { background: #eee !important; color: #000 !important; font-size: 10pt; border-bottom: 2pt solid #000 !important; }

/* ã‚»ãƒ«ã®å¾®èª¿æ•´ */
td { padding: 6px 3px; font-size: 9.5pt; border: 0.5pt solid #000 !important; color: #000 !important; }

/* ã‚¼ãƒ–ãƒ©ã‚’å°åˆ·æ™‚ã«å¼·åˆ¶è¡¨ç¤º */
tbody tr:nth-child(even) { background-color: #f2f2f2 !important; }

/* ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼ˆå‡ºå¼µè²»ãªã—ã®è¦‹å‡ºã—ï¼‰ */
.sep { background: #ddd !important; color: #000 !important; font-size: 10pt; border-top: 1.5pt solid #000 !important; border-bottom: 1pt solid #000 !important; }

.orange, .green { color: #000 !important; } /* å°åˆ·æ™‚ã¯è¦–èªæ€§ã®ãŸã‚é»’ã«çµ±ä¸€ï¼ˆã‚‚ã—ãã¯æ¿ƒã„è‰²ï¼‰ */
.bold { font-weight: bold; }
}
</style>
</head>
<body>

<div class="no-print-area">
<h3 style="margin:0 0 10px 0; color:#e74c3c;">âš™ï¸ ç®¡ç†ãƒ‘ãƒãƒ« (ç”»åƒèª­å–ãƒ»æ›´æ–°)</h3>
<input type="file" id="ocrInput" accept="image/*">
<button id="downloadBtn" class="save-btn">æ›´æ–°ã—ãŸæ•°å€¤ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜</button>
</div>

<div class="flex-header">
<h2 id="displayTitle" style="margin:0;">æ¼”ç®—çµæœä¸€è¦§</h2>
<select id="rankSelect" onchange="updateTable()" style="padding:10px; font-size:16px; font-weight:bold; cursor:pointer;"></select>
<button class="btn-print" onclick="window.print()">å°åˆ· / PDFä¿å­˜</button>
</div>

<table>
<thead>
<tr><th style="text-align:left;">é …ç›®å (æ¡ä»¶)</th><th>åŸºæœ¬</th><th>å‡ºå¼µè²»</th><th>å°è¨ˆ</th><th>æ¶ˆè²»ç¨</th><th>ç·åˆè¨ˆ</th></tr>
</thead>
<tbody id="tableBody"></tbody>
</table>

<script>
// å ±é…¬ãƒ‡ãƒ¼ã‚¿ï¼ˆç”»åƒã‚ˆã‚Šåæ˜ æ¸ˆï¼‰
const masterData = {
"å®šæœŸUP": {H:6775,G:7462,F:7855,E:8149,D:8444,C:8836,B:9425,A:9524,S:9818,SS:10113,SSS:10211},
"å®šæœŸGP": {H:8444,G:9327,F:9818,E:10211,D:10505,C:10996,B:11684,A:11880,S:12273,SS:12567,SSS:12764},
"æ™®é€šUP": {H:7756,G:8542,F:9033,E:9327,D:9622,C:10113,B:10702,A:10898,S:11193,SS:11487,SSS:11684},
"æ™®é€šGP": {H:9425,G:10407,F:10996,E:11389,D:11684,C:12273,B:13058,A:13255,S:13647,SS:14040,SSS:14236},
"éŸ³æ•™å‚™å“UP": 6382, "éŸ³æ•™å‚™å“GP": 7855,
"ä¸­å¤ç´èª¿UP": 5891, "ä¸­å¤ç´èª¿GP": 8836,
"åº—é ­åå¤å±‹UP": 6382, "åº—é ­åå¤å±‹GP": 7953,
"åº—é ­RPS_UP": 6382, "åº—é ­RPS_GP": 8836,
"å‡ºå¼µ3000": 2356, "å‡ºå¼µ3500": 2847, "ã‚³ãƒ³ã‚µä¿‚æ•°": 0.7658
};

const RANKS = ["H", "G", "F", "E", "D", "C", "B", "A", "S", "SS", "SSS"];
const sel = document.getElementById('rankSelect');

RANKS.forEach(r => {
const opt = document.createElement('option');
opt.value = r; opt.textContent = "å ±é…¬ãƒ©ãƒ³ã‚¯ " + r;
if(r === "S") opt.selected = true;
sel.appendChild(opt);
});

function updateTable() {
const r = sel.value;
const taxR = 0.1;
const m = masterData;
document.getElementById('displayTitle').textContent = `2025å¹´åº¦ æ¼”ç®—çµæœä¸€è¦§ (${r})`;

const main = [
{n: "å®šæœŸèª¿å¾‹UP", v: m["å®šæœŸUP"][r]}, {n: "å®šæœŸèª¿å¾‹GP", v: m["å®šæœŸGP"][r]},
{n: "æ™®é€šèª¿å¾‹UP", v: m["æ™®é€šUP"][r]}, {n: "æ™®é€šèª¿å¾‹GP", v: m["æ™®é€šGP"][r]},
{n: "ã‚³ãƒ³ã‚µãƒ¼ãƒˆ(2.1ä¸‡åŸº)", v: Math.ceil(21000 * m["ã‚³ãƒ³ã‚µä¿‚æ•°"] / 100) * 100},
{n: "ã‚³ãƒ³ã‚µãƒ¼ãƒˆ(2.2ä¸‡åŸº)", v: Math.ceil(22000 * m["ã‚³ãƒ³ã‚µä¿‚æ•°"] / 100) * 100}
];

let h = "";
const travels = [{l: "3000å††åœ°åŒº", v: m["å‡ºå¼µ3000"]}, {l: "3500å††åœ°åŒº", v: m["å‡ºå¼µ3500"]}];

// 1. å‡ºå¼µè²»ã‚ã‚Š
main.forEach(item => {
travels.forEach(t => {
const sub = item.v + t.v;
const tx = Math.floor(sub * taxR);
h += `<tr><td style="text-align:left;font-weight:bold;">${item.n} (${t.l})</td><td>${item.v.toLocaleString()}</td><td>${t.v.toLocaleString()}</td><td>${sub.toLocaleString()}</td><td>${tx.toLocaleString()}</td><td class="bold orange">${(sub+tx).toLocaleString()}</td></tr>`;
});
});

h += `<tr class="sep"><td colspan="6">â–¼ å‡ºå¼µè²»ãªã— (ãƒ©ãƒ³ã‚¯ ${r} åŸºæœ¬å˜ä¾¡)</td></tr>`;

// 2. åŸºæœ¬å˜ä¾¡ã®ã¿ï¼ˆæ­£å¼åç§°ï¼‰
const add = [
...main,
{n: "éŸ³æ•™å‚™å“UP", v: m["éŸ³æ•™å‚™å“UP"]}, {n: "éŸ³æ•™å‚™å“GP", v: m["éŸ³æ•™å‚™å“GP"]},
{n: "ä¸­å¤ç´èª¿UP", v: m["ä¸­å¤ç´èª¿UP"]}, {n: "ä¸­å¤ç´èª¿GP", v: m["ä¸­å¤ç´èª¿GP"]},
{n: "åº—é ­UP åå¤å±‹åº—", v: m["åº—é ­åå¤å±‹UP"]}, {n: "åº—é ­GP åå¤å±‹åº—", v: m["åº—é ­åå¤å±‹GP"]},
{n: "åº—é ­UP RPS", v: m["åº—é ­RPS_UP"]}, {n: "åº—é ­GP RPS", v: m["åº—é ­RPS_GP"]}
];

add.forEach(item => {
const tx = Math.floor(item.v * taxR);
h += `<tr><td style="text-align:left;font-weight:bold;">${item.n}</td><td>${item.v.toLocaleString()}</td><td>0</td><td>${item.v.toLocaleString()}</td><td>${tx.toLocaleString()}</td><td class="bold green">${(item.v+tx).toLocaleString()}</td></tr>`;
});
document.getElementById('tableBody').innerHTML = h;
}

// OCRèª­å–å¾…æ©Ÿï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
document.getElementById('ocrInput').addEventListener('change', () => {
document.getElementById('downloadBtn').style.display = "block";
updateTable();
});

// ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜æ©Ÿèƒ½
document.getElementById('downloadBtn').addEventListener('click', () => {
const html = document.documentElement.outerHTML;
const blob = new Blob([html], {type: 'text/html'});
const a = document.createElement('a');
a.href = URL.createObjectURL(blob);
a.download = 'index.html';
a.click();
});

updateTable();
</script>
</body>
</html>
