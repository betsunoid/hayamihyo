<!doctype html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <title>2025年度 演算早見表（名称最適化版）</title>
    <style>
        /* A4縦 1枚に収めるための設定 */
        @page { size: A4 portrait; margin: 8mm 6mm; }
        body { font-family: sans-serif; margin: 0; padding: 0; background: #fff; color: #000; line-height: 1.0; }
        
        /* 操作エリア */
        .no-print-area { padding: 10px; background: #f0f7ff; border-bottom: 2px solid #007bff; display: flex; align-items: center; gap: 15px; }
        select { padding: 6px; font-size: 18px; font-weight: bold; }

        /* テーブル設定：横幅一杯 */
        table { width: 100%; border-collapse: collapse; border: 2.5px solid #000; table-layout: fixed; }
        
        th { 
            background: #333 !important; color: #fff; text-align: center; 
            padding: 6px 2px; font-size: 12px; border: 1px solid #000;
            -webkit-print-color-adjust: exact; 
        }

        /* 各セル：縦幅を「1枚に収まる最大」まで確保 */
        td { 
            border: 1px solid #000; text-align: right; 
            padding: 4.8px 5px; /* 1枚に収まる絶妙な高さ */
            font-weight: bold; font-size: 11.5px;
        }

        /* 項目名列を広く取り、フルネームを表示 */
        td:first-child { text-align: left; width: 42%; font-size: 11.5px; white-space: nowrap; }

        /* グループ見出し */
        .group-header { 
            background: #444 !important; color: #fff; text-align: left; 
            font-size: 11.5px; padding: 5px 10px; -webkit-print-color-adjust: exact;
        }

        /* ゼブラ：グループごとにJSで切り替え */
        .z-on { background-color: #cccccc !important; -webkit-print-color-adjust: exact; }

        .orange { color: #b33a00 !important; }
        .green { color: #006400 !important; }

        @media print {
            .no-print-area { display: none; }
            body { transform: scale(1.0); transform-origin: top; }
        }
    </style>
</head>
<body>

<div class="no-print-area">
    <b>ランク：</b><select id="rankSelect" onchange="updateTable()"></select>
    <button onclick="window.print()" style="padding: 6px 20px; font-weight:bold; cursor:pointer;">印刷する</button>
    <span style="font-size:11px; color:#d00; margin-left:10px;">※背景グラフィックON / 倍率100%設定</span>
</div>

<table id="mainTable">
    <thead>
        <tr>
            <th>項目名 (条件)</th>
            <th>基本</th>
            <th>出張費</th>
            <th>小計</th>
            <th>消費税</th>
            <th>合計(税込)</th>
        </tr>
    </thead>
    <tbody id="tableBody"></tbody>
</table>

<script>
    const RANKS = ["H", "G", "F", "E", "D", "C", "B", "A", "S", "SS", "SSS"];
    const baseData = {
        "定期UP": [6775, 7462, 7855, 8149, 8444, 8836, 9425, 9524, 9818, 10113, 10211],
        "定期GP": [8444, 9327, 9818, 10211, 10505, 10996, 11684, 11880, 12273, 12567, 12764],
        "普通UP": [7756, 8542, 9033, 9327, 9622, 10113, 10702, 10898, 11193, 11487, 11684],
        "普通GP": [9425, 10407, 10996, 11389, 11684, 12273, 13058, 13255, 13647, 14040, 14236],
        "学校UP": [4811, 4811, 4811, 4811, 5302, 5302, 5891, 5891, 5891, 5891, 5891],
        "学校GP": [5793, 5793, 5793, 5793, 6578, 6578, 7265, 7265, 7265, 7265, 7265],
        "学校CF": [0, 0, 0, 0, 7560, 7560, 7560, 8542, 8542, 8542, 8542],
        "学校SW": [0, 0, 0, 0, 0, 0, 0, 8935, 8935, 8935, 8935],
        "T3000": 2356, "T3500": 2847, "T4000": 3338, "CRATE": 0.7658
    };

    const sel = document.getElementById('rankSelect');
    RANKS.forEach((r, idx) => {
        const opt = document.createElement('option');
        opt.value = idx; opt.textContent = "ランク " + r;
        if(r === "S") opt.selected = true;
        sel.appendChild(opt);
    });

    function updateTable() {
        const i = parseInt(sel.value);
        let h = "";
        const c21 = Math.ceil(21000 * baseData.CRATE / 100) * 100;
        const c22 = Math.ceil(22000 * baseData.CRATE / 100) * 100;

        const mainItems = [
            {n:"定期UP", v:baseData.定期UP[i]}, {n:"定期GP", v:baseData.定期GP[i]},
            {n:"普通UP", v:baseData.普通UP[i]}, {n:"普通GP", v:baseData.普通GP[i]},
            {n:"コンサート21000", v:c21}, {n:"コンサート22000", v:c22}
        ];

        // 出張費グループ (3000/3500/4000)
        [{l:"3,000円地域",v:baseData.T3000}, {l:"3,500円地域",v:baseData.T3500}, {l:"4,000円地域",v:baseData.T4000}].forEach(trv => {
            h += `<tr class="group-header"><td colspan="6">【出張費 ${trv.l}】</td></tr>`;
            mainItems.forEach((item, idx) => {
                const sub = item.v + trv.v;
                const tax = Math.floor(sub * 0.1);
                const zebra = (idx % 2 === 1) ? "z-on" : "";
                h += `<tr class="${zebra}"><td>${item.n}</td><td>${item.v.toLocaleString()}</td><td>${trv.v.toLocaleString()}</td><td>${sub.toLocaleString()}</td><td>${tax.toLocaleString()}</td><td class="orange">${(sub+tax).toLocaleString()}</td></tr>`;
            });
        });

        // 出張費なし
        h += `<tr class="group-header"><td colspan="6">【出張費なし】</td></tr>`;
        const freeItems = [
            {n:"学校 UP", v:baseData.学校UP[i]}, {n:"学校 GP", v:baseData.学校GP[i]},
            {n:"学校 CF/S", v:baseData.学校CF[i]}, {n:"学校 SW/B", v:baseData.学校SW[i]},
            ...mainItems,
            {n:"音教備品UP", v:6382}, {n:"音教備品GP", v:7855},
            {n:"納調 UP", v:5891}, {n:"納調 GP", v:8836},
            {n:"店頭 名古屋UP", v:6382}, {n:"店頭 名古屋GP", v:7953},
            {n:"店頭 RPS UP", v:6382}, {n:"店頭 RPS GP", v:8836}
        ].filter(x => x.v > 0);

        freeItems.forEach((item, idx) => {
            const tax = Math.floor(item.v * 0.1);
            const zebra = (idx % 2 === 1) ? "z-on" : "";
            h += `<tr class="${zebra}"><td>${item.n}</td><td>${item.v.toLocaleString()}</td><td>0</td><td>${item.v.toLocaleString()}</td><td>${tax.toLocaleString()}</td><td class="green">${(item.v+tax).toLocaleString()}</td></tr>`;
        });

        document.getElementById('tableBody').innerHTML = h;
    }
    updateTable();
</script>
</body>
</html>


